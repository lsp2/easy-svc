import{J as s,T as t,U as r,P as e,C as o,V as i}from"./index-DDxW1fSN.js";import{r as n}from"./requst-D7HpWZZY.js";const a=s("user",{state:()=>({userId:""}),getters:{isLogin:s=>!!s.userId},actions:{setInfo(s){this.userId=s.userId},resetInfo(){this.reset()},async info(){if(!t())return void this.logout();const s=await n.get("/user/info");this.setInfo(s.user)},async login(s){try{const t=await function(s){return n.post("/user/login",s)}(s);1===t.flag?(r(t.token),this.info(),e.success("登录成功"),setTimeout((()=>{o.push("/")}),500)):-1===t.flag?e.error("密码错误"):e.error("服务器异常错误")}catch(t){throw i(),t}},async logout(){},async register(s){try{const t=await function(s){return n.post("/user/register",s)}(s);1===t.flag?(this.login(s),e.success("注册成功")):-1===t.flag&&e.warning("注册失败，请更换用户名重试")}catch(t){throw t}}},persist:!0});export{a as u};
